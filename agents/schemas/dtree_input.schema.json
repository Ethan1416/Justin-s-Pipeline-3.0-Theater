{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "dtree_input.schema.json",
  "title": "Decision Tree Generator Input Schema",
  "description": "Input schema for the decision_tree_generator agent in the NCLEX pipeline",
  "type": "object",
  "required": ["slide_context", "tree_data"],
  "properties": {
    "slide_context": {
      "type": "object",
      "required": ["slide_number", "section_name", "title"],
      "properties": {
        "slide_number": {
          "type": "integer",
          "minimum": 1,
          "description": "Slide number within the section"
        },
        "section_name": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the section this slide belongs to"
        },
        "section_number": {
          "type": "integer",
          "minimum": 1,
          "description": "Section number"
        },
        "title": {
          "type": "string",
          "maxLength": 64,
          "description": "Slide title"
        },
        "domain": {
          "type": "string",
          "enum": ["fundamentals", "pharmacology", "medical_surgical", "ob_maternity", "pediatric", "mental_health"],
          "description": "NCLEX content domain"
        }
      }
    },
    "tree_data": {
      "type": "object",
      "required": ["tree_purpose", "level1"],
      "properties": {
        "tree_purpose": {
          "type": "string",
          "enum": ["diagnostic_criteria", "sequential_decision", "classification", "rule_out"],
          "description": "Purpose of the decision tree"
        },
        "level1": {
          "type": "object",
          "required": ["header", "question", "paths"],
          "properties": {
            "header": {
              "type": "string",
              "maxLength": 20,
              "description": "Level 1 category name"
            },
            "question": {
              "type": "string",
              "maxLength": 50,
              "description": "Decision question (25 chars/line, 2 lines max)"
            },
            "paths": {
              "type": "array",
              "minItems": 2,
              "maxItems": 3,
              "items": {
                "type": "string",
                "maxLength": 12
              },
              "description": "Path labels leading from this node"
            }
          }
        },
        "level2": {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "items": {
            "type": "object",
            "required": ["header", "parent_path"],
            "properties": {
              "header": {
                "type": "string",
                "maxLength": 20
              },
              "question": {
                "type": "string",
                "maxLength": 50
              },
              "paths": {
                "type": "array",
                "items": {
                  "type": "string",
                  "maxLength": 12
                }
              },
              "parent_path": {
                "type": "string",
                "description": "Which Level 1 path leads here"
              },
              "is_terminal": {
                "type": "boolean",
                "default": false,
                "description": "If true, this is an outcome node, not a decision"
              }
            }
          },
          "description": "Level 2 decision nodes"
        },
        "outcomes": {
          "type": "array",
          "minItems": 2,
          "maxItems": 8,
          "items": {
            "type": "object",
            "required": ["name", "parent", "color"],
            "properties": {
              "name": {
                "type": "string",
                "maxLength": 40,
                "description": "Outcome/diagnosis name (20 chars/line, 2 lines max)"
              },
              "parent": {
                "type": "string",
                "description": "Parent path (e.g., L2A-YES)"
              },
              "color": {
                "type": "string",
                "enum": ["green", "red", "blue", "purple"],
                "description": "Outcome color coding"
              },
              "header_label": {
                "type": "string",
                "maxLength": 20,
                "default": "DIAGNOSIS",
                "description": "Header text for outcome box"
              }
            }
          },
          "description": "Terminal outcome nodes"
        }
      }
    },
    "layout_preference": {
      "type": "string",
      "enum": ["A", "B", "C", "D", "E", "F", "AUTO"],
      "default": "AUTO",
      "description": "Preferred layout: A=Three-level binary (1-2-4), B=Two-level binary (1-2), C=Two-level triple (1-3), D=Three-level asymmetric, E=Three-level extended (1-2-6), F=Four-level binary, AUTO=auto-select"
    }
  }
}
