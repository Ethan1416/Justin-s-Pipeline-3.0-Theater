{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "table_output.schema.json",
  "title": "Table Generator Output Schema",
  "description": "Output schema for the table_generator agent in the NCLEX pipeline",
  "type": "object",
  "required": ["visual_spec", "validation", "presenter_notes"],
  "properties": {
    "visual_spec": {
      "type": "object",
      "required": ["type", "layout", "title", "data"],
      "properties": {
        "type": {
          "type": "string",
          "const": "TABLE"
        },
        "layout": {
          "type": "string",
          "enum": ["A", "B", "C", "D", "E"],
          "description": "Selected layout: A=Standard Comparison, B=Wide Comparison, C=Category List, D=Compact Reference, E=Tall Comparison"
        },
        "title": {
          "type": "string",
          "maxLength": 50,
          "description": "Table title"
        },
        "data": {
          "type": "object",
          "required": ["headers", "rows", "dimensions"],
          "properties": {
            "headers": {
              "type": "array",
              "minItems": 2,
              "maxItems": 6,
              "items": {
                "type": "string",
                "maxLength": 25
              },
              "description": "Column header text (max 25 chars each)"
            },
            "rows": {
              "type": "array",
              "minItems": 1,
              "maxItems": 9,
              "items": {
                "type": "array",
                "items": {
                  "type": "string",
                  "maxLength": 60
                }
              },
              "description": "Data rows (max 60 chars per cell)"
            },
            "dimensions": {
              "type": "object",
              "required": ["columns", "rows"],
              "properties": {
                "columns": {
                  "type": "integer",
                  "minimum": 2,
                  "maximum": 6
                },
                "rows": {
                  "type": "integer",
                  "minimum": 2,
                  "maximum": 10,
                  "description": "Total rows including header"
                }
              }
            }
          }
        }
      }
    },
    "validation": {
      "type": "object",
      "required": ["is_valid", "checks"],
      "properties": {
        "is_valid": {
          "type": "boolean",
          "description": "Overall validation status"
        },
        "checks": {
          "type": "object",
          "properties": {
            "header_char_limits": {
              "type": "boolean",
              "description": "All headers within 25 char limit"
            },
            "cell_char_limits": {
              "type": "boolean",
              "description": "All cells within 60 char limit (30 chars/line, 2 lines)"
            },
            "row_count_valid": {
              "type": "boolean",
              "description": "Row count between 2-10"
            },
            "column_count_valid": {
              "type": "boolean",
              "description": "Column count between 2-6"
            },
            "content_complete": {
              "type": "boolean",
              "description": "All cells have content"
            }
          }
        },
        "warnings": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Non-blocking warnings"
        },
        "errors": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Blocking errors that prevent generation"
        }
      }
    },
    "presenter_notes": {
      "type": "object",
      "required": ["text", "word_count"],
      "properties": {
        "text": {
          "type": "string",
          "description": "Presenter notes walking through table content"
        },
        "word_count": {
          "type": "integer",
          "minimum": 150,
          "maximum": 450,
          "description": "Word count (150-300 typical)"
        },
        "estimated_duration_seconds": {
          "type": "integer",
          "minimum": 60,
          "maximum": 180,
          "description": "Estimated delivery time"
        }
      }
    },
    "rendering_metadata": {
      "type": "object",
      "properties": {
        "font_size": {
          "type": "integer",
          "enum": [18, 20],
          "description": "Font size used (18pt for dense, 20pt default)"
        },
        "row_height_inches": {
          "type": "number",
          "description": "Calculated row height"
        },
        "column_widths": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "Column widths in inches"
        }
      }
    }
  }
}
