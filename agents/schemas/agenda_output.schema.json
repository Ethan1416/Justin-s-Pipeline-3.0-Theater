{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://theater-pipeline/schemas/agenda_output.schema.json",
  "title": "Agenda Slide Output Schema",
  "description": "HARDCODED schema for agenda slide generation output. Validated by agenda_slide_validator.",
  "type": "object",
  "required": [
    "agenda",
    "slide_content",
    "validation"
  ],
  "properties": {
    "agenda": {
      "type": "object",
      "required": [
        "unit_info",
        "lesson_title",
        "total_duration",
        "components",
        "learning_objectives_display",
        "materials_preview"
      ],
      "properties": {
        "unit_info": {
          "type": "string",
          "pattern": "^Unit [1-4]: .+ - Day [0-9]+/[0-9]+$",
          "description": "Format: 'Unit X: [Name] - Day Y/Z'"
        },
        "date_placeholder": {
          "type": "string",
          "const": "[DATE]",
          "description": "Placeholder for actual date"
        },
        "lesson_title": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100,
          "description": "Lesson title"
        },
        "total_duration": {
          "type": "integer",
          "enum": [45, 56, 75, 90],
          "description": "Total class duration in minutes (HARDCODED values)"
        },
        "components": {
          "type": "array",
          "minItems": 6,
          "maxItems": 6,
          "items": {
            "$ref": "#/$defs/component"
          },
          "description": "Exactly 6 components required (HARDCODED)"
        },
        "learning_objectives_display": {
          "type": "array",
          "minItems": 1,
          "maxItems": 3,
          "items": {
            "type": "string",
            "pattern": "^[0-9]+\\. .+$"
          },
          "description": "Numbered objectives (1-3 items, HARDCODED)"
        },
        "materials_preview": {
          "type": "array",
          "minItems": 3,
          "maxItems": 5,
          "items": {
            "type": "string",
            "maxLength": 50
          },
          "description": "3-5 materials (HARDCODED)"
        }
      }
    },
    "slide_content": {
      "type": "object",
      "required": [
        "slide_number",
        "slide_type",
        "title",
        "body_sections"
      ],
      "properties": {
        "slide_number": {
          "type": "integer",
          "const": 1,
          "description": "Agenda is always Slide 1"
        },
        "slide_type": {
          "type": "string",
          "const": "agenda",
          "description": "Slide type identifier"
        },
        "title": {
          "type": "string",
          "description": "Slide title (unit info header)"
        },
        "subtitle": {
          "type": "string",
          "description": "Lesson title in quotes"
        },
        "body_sections": {
          "type": "array",
          "minItems": 2,
          "maxItems": 2,
          "items": {
            "type": "object",
            "properties": {
              "header": {
                "type": "string",
                "enum": ["TODAY'S AGENDA", "OBJECTIVES"]
              },
              "items": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "description": "Two sections: agenda items and objectives"
        },
        "presenter_notes": {
          "type": "string",
          "description": "Verbatim presenter notes for agenda slide"
        }
      }
    },
    "validation": {
      "type": "object",
      "required": [
        "valid",
        "score"
      ],
      "properties": {
        "valid": {
          "type": "boolean",
          "description": "Whether agenda passes all validation rules"
        },
        "score": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Validation score (0-100)"
        },
        "issues": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of validation issues (must be empty for valid=true)"
        },
        "warnings": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of validation warnings"
        }
      }
    }
  },
  "$defs": {
    "component": {
      "type": "object",
      "required": [
        "sequence",
        "component",
        "duration_minutes",
        "time_marker",
        "description"
      ],
      "properties": {
        "sequence": {
          "type": "integer",
          "minimum": 1,
          "maximum": 6,
          "description": "Component order (1-6)"
        },
        "component": {
          "type": "string",
          "enum": [
            "Agenda & Objectives",
            "Warmup",
            "Lecture",
            "Activity",
            "Reflection & Exit Ticket",
            "Buffer/Transition"
          ],
          "description": "Component display name"
        },
        "duration_minutes": {
          "type": "integer",
          "minimum": 3,
          "maximum": 30,
          "description": "Duration in minutes"
        },
        "time_marker": {
          "type": "string",
          "pattern": "^[0-9]+:00-[0-9]+:00$",
          "description": "Time marker (format: 'MM:00-MM:00')"
        },
        "description": {
          "type": "string",
          "maxLength": 60,
          "description": "Component description (max 60 chars, HARDCODED)"
        }
      }
    }
  },
  "_hardcoded_rules": {
    "R1": "total_duration must match class_period",
    "R2": "Exactly 6 components required",
    "R3": "1-3 learning objectives required",
    "R4": "3-5 materials required",
    "R5": "Time markers must be sequential",
    "R6": "Descriptions must be under 60 characters"
  }
}
